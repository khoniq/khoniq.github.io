#!/bin/sh
cd $(dirname $0)/..
man=$(pwd)/man
pub=$(pwd)/pub
tmp=$(pwd)/.tmp

#journal index
grep "\<h1\>" $man/journal/posts/*.html | sort -r | sed 's/^.*journal\///;s/:<h1>/ /;s/<\/h1>//' |
awk 'BEGIN{
  print "<!doctype html>"
  print "<html><head><meta charset=\"utf-8\"></head><body>"
  print "<h1>日記</h1><ul>"
}
{
  path=$1          # posts/20260208.html
  title=$2         # 標題（h1 內容）
  date=path
  sub(/^posts\//,"",date)
  sub(/\.html$/,"",date)

  printf "<li>[%s] <a href=\"%s\">%s</a></li>\n",date,path,title
}
END{
  print "</ul></body></html>"
}' > $man/journal/index.html
